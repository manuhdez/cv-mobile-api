module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t){e.exports=require("mongoose")},function(e,t){e.exports=require("express")},function(e,t,r){"use strict";const n=r(0),o=n.Schema,i=new o({name:{type:String,required:!0,unique:!0},docType:{type:String,required:!0},docNumber:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0,trim:!0},website:{type:String,trim:!0,unique:!0},address:{country:{type:String,required:!0},street:{type:String},city:{type:String},zipcode:{type:Number}},socialUrls:[Object],logoURL:{type:String,trim:!0},bio:{type:String},employees:{type:Number},phone:{type:Number},registeredDate:{type:Date,default:Date.now},jobOffers:[{type:o.Types.ObjectId,ref:"JobOffer"}]}),a=n.model("Company",i);e.exports=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const o=n.default.Schema,i=new o({origin:{type:o.Types.ObjectId,ref:"Survey",required:!0},originTitle:{type:String,required:!0},totalAnswers:Number,answers:[{question:String,options:[{value:{type:String,required:!0},count:Number}]}]}),a=n.default.model("Summary",i);t.default=a},function(e,t,r){"use strict";var n=c(r(1)),o=c(r(5)),i=c(r(6)),a=c(r(7)),s=c(r(8)),l=c(r(0)),d=c(r(9)),u=c(r(10));function c(e){return e&&e.__esModule?e:{default:e}}const f=(0,n.default)();f.use((0,s.default)()),f.use((0,d.default)("UA-127831712-2")),f.use((0,i.default)({filter:function(e,t){if(e.headers["x-no-compression"])return!1}}));f.use((0,o.default)("combined")),f.use("/uploads",n.default.static("uploads")),f.use(a.default.json()),f.use(a.default.urlencoded({extended:!1}));let p="mongodb://manuhdez:cv-mobile-api-2018@ds225703.mlab.com:25703/cv-mobile-api";console.log("production",p),l.default.connect(p,{useNewUrlParser:!0});const g=l.default.connection;g.on("error",e=>{console.error("Mongodb connection error:",e)}),g.on("open",()=>{console.log("Mongodb connected successfully")}),f.use((e,t,r)=>{if(t.header("Access-Control-Allow-Origin","*"),t.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),"OPTIONS"===e.method)return t.header("Access-Control-Allow-Methods","GET, PUT, POST, DELETE"),t.status(200).json({});r()}),f.get("/",(e,t)=>{t.redirect("/docs")}),f.get("/docs",(e,t)=>{t.sendfile("views/docs.html")}),f.use("/api",u.default),f.use((e,t,r)=>{const n=new Error("Page not found");return n.status=404,r(n)}),f.use((e,t,r,n)=>{r.status(e.status||500),r.json({error:e.message})});const m=process.env.PORT||3e3;f.listen(m,e=>{e?process.exit(e):console.log(`App listening on 'http://localhost:${m}'...\n           ---\n           Running on production\n           ---\n      `)})},function(e,t){e.exports=require("morgan")},function(e,t){e.exports=require("compression")},function(e,t){e.exports=require("body-parser")},function(e,t){e.exports=require("helmet")},function(e,t){e.exports=require("express-ga-middleware")},function(e,t,r){"use strict";var n=f(r(1)),o=f(r(11)),i=f(r(12)),a=f(r(14)),s=f(r(16)),l=f(r(18)),d=f(r(19)),u=f(r(21)),c=f(r(23));function f(e){return e&&e.__esModule?e:{default:e}}const p=n.default.Router(),g=o.default.diskStorage({destination:function(e,t,r){r(null,"uploads/")},filename:function(e,t,r){r(null,(new Date).toISOString().replace(/:/g,"_")+t.originalname)}}),m=(0,o.default)({storage:g,limits:{fileSize:3145728},fileFilter:function(e,t,r){"image/jpeg"===t.mimetype||"image/png"===t.mimetype?r(null,!0):r(new Error("Not a valid file format"),!1)}});p.get("/",(e,t,r)=>t.json({welcome:"There is a list with useful links",links:{users:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/users`,skills:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/skills`,languages:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/langs`,companies:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/companies`,jobOffers:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/jobOffers`,surveys:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/surveys`,summaries:`${e.protocol}://${"localhost"===e.hostname?"localhost:3000":e.hostname}/api/summaries`}})),p.get("/users",i.default.getAll),p.post("/users",m.single("profilePicture"),i.default.add),p.get("/users/pages/:pageId",i.default.getPage),p.get("/users/:id",i.default.getById),p.put("/users/:id",m.single("profilePicture"),i.default.update),p.delete("/users/:id",i.default.delete),p.get("/langs",a.default.getAll),p.post("/langs",a.default.add),p.get("/langs/:id",a.default.getById),p.delete("/langs/:id",a.default.delete),p.get("/skills",s.default.getAll),p.post("/skills",s.default.add),p.get("/skills/:id",s.default.getById),p.delete("/skills/:id",s.default.delete),p.get("/companies",l.default.getAll),p.post("/companies",m.single("logoURL"),l.default.add),p.get("/companies/:id",l.default.getById),p.put("/companies/:id",m.single("logoURL"),l.default.update),p.delete("/companies/:id",l.default.delete),p.get("/offers",d.default.get),p.post("/offers",d.default.add),p.get("/offers/:id",d.default.getById),p.delete("/offers/:id",d.default.delete),p.get("/surveys",u.default.get),p.post("/surveys",u.default.add),p.delete("/surveys/:id",u.default.delete),p.get("/summaries",c.default.get),p.get("/summaries/:origin",c.default.getByOrigin),e.exports=p},function(e,t){e.exports=require("multer")},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(13));t.getAll=((e,t,r)=>{n.default.find().then(e=>t.json(e)).catch(e=>r(e))}),t.getPage=((e,t,r)=>{n.default.find().skip(10*(e.params.pageId-1)).limit(10).then(e=>t.json(e)).catch(e=>r(e))}),t.add=((e,t,r)=>{let{name:o,username:i,email:a,phone:s,gender:l,address:d,company:u,jobTitle:c,website:f,birthDate:p,experience:g,languages:m,skills:y}=e.body,h=JSON.parse(d),b=JSON.parse(m),S=JSON.parse(y);if(o&&a&&i){const d={name:o,username:i,email:a,phone:s,gender:l,parsedAddress:h,company:u,jobTitle:c,website:f,birthDate:p,experience:g,parsedLangs:b,parsedSkills:S};e.file&&void 0!==e.file?d.profilePicture=`${e.protocol}://${e.hostname}/${e.file.path}`:void 0===e.file&&(d.profilePicture=`${e.protocol}://${e.hostname}/uploads/default_avatar.png`),n.default.create(d,function(e,n){return e?r(e):t.json(n)})}else t.json({error:"Name, username, email and country properties are required."})}),t.getById=((e,t,r)=>{n.default.findById(e.params.id).populate("skills").populate("languages").exec((e,n)=>{if(e)return r(e);t.json(n)})}),t.update=((e,t,r)=>{let o=Object.assign({},e.body);e.file&&void 0!==e.file&&(o.profilePicture=`${e.protocol}://${e.hostname}/${e.file.path}`),n.default.findByIdAndUpdate(e.params.id,o).exec(n=>{if(n)return r(n);t.redirect(`/api/users/${e.params.id}`)})}),t.delete=((e,t,r)=>{n.default.findByIdAndRemove(e.params.id,function(e){if(e)return r(e);t.redirect("/api/users/")})})},function(e,t,r){"use strict";const n=r(0),o=n.Schema,i=new o({name:{type:String,required:!0},username:{type:String,required:!0},email:{type:String,unique:!0,required:!0},phone:{type:String,unique:!0},gender:String,address:{country:{type:String,required:!0},city:{type:String},street:{type:String},zipcode:{type:Number}},company:String,jobTitle:String,languages:[{type:[o.Types.ObjectId],ref:"Language"}],skills:[{type:[o.Types.ObjectId],ref:"Skill"}],experience:String,birthDate:Date,website:{type:String,trim:!0,unique:!0},profilePicture:{type:String,trim:!0},registeredDate:{type:Date,default:Date.now}}),a=n.model("User",i);e.exports=a},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(15));t.getAll=((e,t,r)=>{n.default.find().then(e=>t.json(e)).catch(e=>r(e))}),t.getById=((e,t,r)=>{n.default.findById(e.params.id).then(e=>t.json(e)).catch(e=>r(e))}),t.add=((e,t,r)=>{let{label:o}=e.body;o&&n.default.create({label:o},(e,n)=>e?r(e):t.json(n))}),t.delete=((e,t,r)=>{n.default.findByIdAndDelete(e.params.id,e=>e?r(e):t.json({message:"Language successfully deleted."}))})},function(e,t,r){"use strict";const n=r(0),o=new(0,n.Schema)({label:{type:String,required:!0,unique:!0}}),i=n.model("Language",o);e.exports=i},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(17));t.getAll=((e,t,r)=>{n.default.find().then(e=>t.json(e)).catch(e=>r(e))}),t.getById=((e,t,r)=>{n.default.findById(e.params.id).then(e=>t.json(e)).catch(e=>r(e))}),t.add=((e,t,r)=>{let{type:o,label:i}=e.body;if(o&&i){let e={type:o,label:i};n.default.create(e,(e,n)=>e?r(e):t.json(n))}}),t.delete=((e,t,r)=>{n.default.findByIdAndDelete(e.params.id,e=>e?r(e):t.json({message:"The skill was removed successfully"}))})},function(e,t,r){"use strict";const n=r(0),o=new(0,n.Schema)({type:{type:String,required:!0},label:{type:String,required:!0}}),i=n.model("Skill",o);e.exports=i},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(2));t.getAll=((e,t,r)=>{n.default.find().then(e=>t.json(e)).catch(e=>r(e))}),t.getById=((e,t,r)=>{n.default.findById(e.params.id).populate("jobOffers").then(e=>t.json(e)).catch(e=>r(e))}),t.add=((e,t,r)=>{let{name:o,docType:i,docNumber:a,email:s,website:l,address:d,socialUrls:u,bio:c,employees:f,phone:p,jobOffers:g}=e.body;if(o&&s&&i&&a&&d.country){const m={name:o,docType:i,docNumber:a,email:s,website:l,address:d,socialUrls:u,bio:c,employees:f,phone:p,jobOffers:g};e.file&&void 0!==e.file&&(m.logoURL=`${e.protocol}://${e.hostname}/${e.file.path}`),n.default.create(m,(e,n)=>e?r(e):t.json(n))}else t.json({error:"Not all required data was sent"})}),t.update=((e,t,r)=>{let o=Object.assign({},e.body);e.file&&(o.logoURL=`${e.protocol}://${e.hostname}/${e.file.path}`),n.default.findByIdAndUpdate(e.params.id,o).exec(n=>n?r(n):t.redirect(`/api/companies/${e.params.id}`))}),t.delete=((e,t,r)=>{n.default.findByIdAndDelete(e.params.id,e=>{if(e)return r(e);t.json({message:"Company profile succesfully deleted."})})})},function(e,t,r){"use strict";var n=i(r(20)),o=i(r(2));function i(e){return e&&e.__esModule?e:{default:e}}t.get=((e,t)=>{n.default.find().then(e=>t.json(e)).catch(e=>next(e))}),t.getById=((e,t,r)=>{n.default.findById(e.params.id).then(e=>t.json(e)).catch(e=>r(e))}),t.add=((e,t,r)=>{let{title:i,position:a,vacancies:s,description:l,companyEmail:d}=e.body;const u={title:i,position:a,vacancies:s,description:l,companyEmail:d};n.default.create(u,(e,n)=>{if(e)return r(e);o.default.findOneAndUpdate({email:d},{$push:{jobOffers:n._id}}).then(()=>t.json(n))})}),t.delete=((e,t,r)=>{n.default.findByIdAndDelete(e.params.id,(e,n)=>{if(e)return r(e);o.default.findOneAndUpdate({email:n.companyEmail},{$pull:{jobOffers:n._id}}).then(e=>t.redirect(`/api/companies/${e._id}`)).catch(e=>r(e))})})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return e&&e.__esModule?e:{default:e}}(r(0));const o=new n.default.Schema({companyEmail:{type:String,required:!0,trim:!0},title:{type:String,required:!0},position:{type:String,required:!0},vacancies:{type:Number,required:!0},description:String,publicationDate:{type:Date,default:Date.now}}),i=n.default.model("JobOffer",o);t.default=i},function(e,t,r){"use strict";var n=i(r(22)),o=i(r(3));function i(e){return e&&e.__esModule?e:{default:e}}t.get=((e,t,r)=>{n.default.find().then(e=>t.json(e)).catch(e=>r(e))}),t.add=((e,t,r)=>{let{header:i,elements:a}=e.body,s={header:i,elements:a};n.default.create(s,(e,n)=>{if(e)return r(e);o.default.create({origin:n._id,originTitle:n.header.title,totalAnswers:0,answers:[]},e=>e?r(e):t.json(n))})}),t.delete=((e,t,r)=>{n.default.findByIdAndDelete(e.params.id,n=>{if(n)return r(n);o.default.findOneAndDelete({origin:e.params.id}).then(()=>t.json({message:"Survey entry successfully removed"})).catch(e=>r(e))})})},function(e,t,r){"use strict";const n=r(0),o=new(0,n.Schema)({header:{title:{type:String,required:!0},subtitle:{type:String},startDate:{type:Date,default:Date.now},endDate:{type:Date,required:!0},description:{type:String,required:!0}},elements:[{type:{type:String,required:!0},label:{type:String,required:!0},name:{type:String,required:!0},values:[{label:{type:String,required:!0},value:{type:String,required:!0}}]}]}),i=n.model("Survey",o);e.exports=i},function(e,t,r){"use strict";var n=function(e){return e&&e.__esModule?e:{default:e}}(r(3));t.get=((e,t,r)=>{n.default.find().then(e=>t.json(e)).catch(e=>r(e))}),t.getByOrigin=((e,t,r)=>{console.log(e.params.origin),n.default.find({origin:e.params.origin}).populate("origin").then(e=>t.json(e)).catch(e=>r(e))})}]);